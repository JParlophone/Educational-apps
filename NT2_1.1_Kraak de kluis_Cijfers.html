<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NT2 Bingo Safe</title>
    <style>
        :root { --primary: #2196F3; --success: #4CAF50; --text: #333; }
        body { font-family: 'Segoe UI', sans-serif; background: transparent; margin: 0; padding: 5px; text-align: center; color: var(--text); }
        .container { max-width: 500px; margin: 0 auto; background: white; border-radius: 8px; padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        .menu-btn { display: block; width: 100%; padding: 12px; margin: 5px 0; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; color: white; font-size: 1rem; }
        .btn-teacher { background: var(--primary); }
        .btn-student { background: var(--success); }
        .btn-reset { background: #f44336; }
        
        select { padding: 8px; width: 100%; margin-bottom: 8px; border: 1px solid #ccc; border-radius: 4px; }
        
        #current-number { font-size: 4rem; font-weight: bold; color: var(--primary); background: #eef; border-radius: 8px; margin: 10px 0; height: 80px; display: flex; align-items: center; justify-content: center; }
        .history-box { max-height: 50px; overflow-y: auto; font-size: 0.85rem; color: #666; border-top: 1px solid #eee; padding-top: 5px; }
        
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-top: 10px; }
        .cell { background: #eee; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; font-weight: bold; border-radius: 5px; cursor: pointer; user-select: none; border: 2px solid transparent; }
        .cell.marked { background: var(--success); color: white; text-decoration: line-through; }
        
        .hidden { display: none; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 100; color: white; }
        .overlay h1 { font-size: 3rem; animation: pop 0.5s infinite alternate; }
        @keyframes pop { from { transform: scale(1); } to { transform: scale(1.1); } }
    </style>
</head>
<body>

    <div class="container" id="menu">
        <h2>Kies uw rol:</h2>
        <button class="menu-btn btn-teacher" onclick="init('teacher')">üë®‚Äçüè´ Docent</button>
        <button class="menu-btn btn-student" onclick="init('student')">üôã Cursist</button>
    </div>

    <div class="container hidden" id="teacher-ui">
        <select id="t-range" onchange="resetGame()">
            <option value="20">1 - 20</option>
            <option value="50">1 - 50</option>
            <option value="100">1 - 100</option>
            <option value="tens">Tientallen</option>
        </select>
        <div id="current-number">?</div>
        <button class="menu-btn btn-teacher" onclick="drawNumber()">Trek Nummer</button>
        <button class="menu-btn btn-reset" onclick="resetGame()">Reset</button>
        <div class="history-box">Geschiedenis: <span id="history-list">-</span></div>
        <button onclick="location.reload()" style="background:none; border:none; color:#999; cursor:pointer; margin-top:5px;">Terug</button>
    </div>

    <div class="container hidden" id="student-ui">
        <select id="s-range">
            <option value="20">1 - 20</option>
            <option value="50">1 - 50</option>
            <option value="100">1 - 100</option>
            <option value="tens">Tientallen</option>
        </select>
        <button class="menu-btn btn-student" onclick="generateCard()">Nieuwe Kaart</button>
        <div class="grid" id="bingo-card"></div>
        <button onclick="location.reload()" style="background:none; border:none; color:#999; cursor:pointer; margin-top:10px;">Terug</button>
    </div>

    <div class="overlay" id="win-screen">
        <h1>BINGO!</h1>
        <button class="menu-btn btn-student" style="width:auto; padding:10px 30px;" onclick="document.getElementById('win-screen').style.display='none'">Sluiten</button>
    </div>

<script>
    // --- VEILIGE AUDIO SETUP ---
    let voices = [];
    const synth = window.speechSynthesis;
    let audioEnabled = false;

    if (synth) {
        audioEnabled = true;
        function loadVoices() {
            voices = synth.getVoices().filter(v => v.lang.includes('nl'));
        }
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = loadVoices;
        }
        loadVoices();
    }

    function speak(text) {
        if (!audioEnabled) return; // Doe niets als audio stuk is
        try {
            synth.cancel();
            const u = new SpeechSynthesisUtterance(text);
            if(voices.length > 0) u.voice = voices[0];
            u.rate = 0.85; 
            synth.speak(u);
        } catch(e) {
            console.log("Audio fout:", e);
        }
    }

    // --- GAME LOGICA ---
    let drawnNumbers = [];

    function init(role) {
        document.getElementById('menu').classList.add('hidden');
        document.getElementById(role + '-ui').classList.remove('hidden');
        if(role === 'student') generateCard();
    }

    function getRandom(mode) {
        if(mode === 'tens') return (Math.floor(Math.random() * 10) + 1) * 10;
        return Math.floor(Math.random() * parseInt(mode)) + 1;
    }

    function drawNumber() {
        const mode = document.getElementById('t-range').value;
        const limit = mode === 'tens' ? 10 : parseInt(mode);
        
        if (drawnNumbers.length >= limit) {
            alert("Alle nummers zijn getrokken!");
            return;
        }

        let num;
        do { num = getRandom(mode); } while (drawnNumbers.includes(num));

        drawnNumbers.unshift(num);
        document.getElementById('current-number').innerText = num;
        document.getElementById('history-list').innerText = drawnNumbers.join(', ');
        speak(num);
    }

    function resetGame() {
        drawnNumbers = [];
        document.getElementById('current-number').innerText = "?";
        document.getElementById('history-list').innerText = "-";
    }

    function generateCard() {
        const grid = document.getElementById('bingo-card');
        const mode = document.getElementById('s-range').value;
        grid.innerHTML = '';
        
        let nums = new Set();
        let safety = 0;
        while(nums.size < 9 && safety < 500) {
            nums.add(getRandom(mode));
            safety++;
        }

        Array.from(nums).sort((a,b)=>a-b).forEach(n => {
            let d = document.createElement('div');
            d.className = 'cell';
            d.innerText = n;
            d.onclick = () => {
                d.classList.toggle('marked');
                checkWin();
            };
            grid.appendChild(d);
        });
    }

    function checkWin() {
        const total = document.querySelectorAll('#student-ui .cell').length;
        const marked = document.querySelectorAll('#student-ui .cell.marked').length;
        if(total === marked && total > 0) {
            speak("Bingo! Ik heb bingo!");
            document.getElementById('win-screen').style.display = 'flex';
        }
    }
</script>
</body>
</html>
