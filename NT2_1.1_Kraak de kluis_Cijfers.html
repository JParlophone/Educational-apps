<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kraak de Kluis - NT2</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #2c3e50;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: white;
        }

        /* DE KLUIS CONTAINER */
        .safe-box {
            background: linear-gradient(145deg, #4b5d67, #3c4b52);
            width: 340px;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 10px 10px 30px rgba(0,0,0,0.5), inset 2px 2px 5px rgba(255,255,255,0.1);
            border: 8px solid #222;
            position: relative;
            text-align: center;
        }

        /* HET DISPLAY */
        .display {
            background-color: #000;
            color: #0f0; /* Retro Groen */
            font-family: 'Courier New', monospace;
            font-size: 2.5rem;
            height: 60px;
            line-height: 60px;
            margin-bottom: 20px;
            border-radius: 5px;
            border: 4px solid #555;
            box-shadow: inset 0 0 10px #000;
            letter-spacing: 5px;
            position: relative;
            overflow: hidden;
        }

        /* KNOPPEN */
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .key {
            background: #e0e0e0;
            color: #333;
            border: none;
            padding: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 0 #999;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        .key:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #999;
        }

        .key-action { background: #f1c40f; } /* Geel voor correctie */
        .key-enter { background: #2ecc71; color: white; box-shadow: 0 4px 0 #27ae60; }

        /* CONTROLS */
        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .btn-small {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .btn-small:hover { background: #2980b9; }

        /* DE DEUR ANIMATIE */
        .door-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(46, 204, 113, 0.9);
            border-radius: 12px;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        .door-overlay h1 { font-size: 3rem; margin: 0; text-shadow: 2px 2px 0 #000; }
        .gold-bar { font-size: 4rem; margin-top: 10px; animation: bounce 1s infinite; }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        
        /* Level Selectie */
        select { padding: 5px; border-radius: 5px; }

    </style>
</head>
<body>

    <div class="safe-box">
        <div class="door-overlay" id="win-screen">
            <h1>OPEN!</h1>
            <div class="gold-bar">ðŸ’°ðŸ’ŽðŸ’°</div>
            <button class="btn-small" style="margin-top:20px; background:#fff; color:#333;" onclick="startGame()">Volgende Kluis</button>
        </div>

        <div class="controls">
            <select id="level-select">
                <option value="2">Niveau 1 (2 cijfers)</option>
                <option value="3" selected>Niveau 2 (3 cijfers)</option>
                <option value="4">Niveau 3 (4 cijfers)</option>
            </select>
            <button class="btn-small" onclick="playAudio()">ðŸ”Š Herhaal</button>
        </div>

        <div class="display" id="display">_ _ _</div>

        <div class="keypad">
            <button class="key" onclick="press(1)">1</button>
            <button class="key" onclick="press(2)">2</button>
            <button class="key" onclick="press(3)">3</button>
            <button class="key" onclick="press(4)">4</button>
            <button class="key" onclick="press(5)">5</button>
            <button class="key" onclick="press(6)">6</button>
            <button class="key" onclick="press(7)">7</button>
            <button class="key" onclick="press(8)">8</button>
            <button class="key" onclick="press(9)">9</button>
            <button class="key key-action" onclick="clearInput()">C</button>
            <button class="key" onclick="press(0)">0</button>
            <button class="key key-enter" onclick="checkCode()">OK</button>
        </div>
        
        <div style="font-size: 0.8rem; color: #ccc; margin-top:10px;">
            Luister naar de code en toets in.
        </div>
    </div>

<script>
    // --- VARIABELEN ---
    let secretCode = [];
    let userContext = ""; // Wat de gebruiker intypt
    let voices = [];
    
    // --- AUDIO SETUP ---
    function loadVoices() {
        voices = window.speechSynthesis.getVoices().filter(v => v.lang.includes('nl') || v.lang.includes('NL'));
    }
    window.speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    function speak(text) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        if(voices.length > 0) u.voice = voices[0]; // Eerste NL stem
        u.rate = 0.85; // Iets trager
        window.speechSynthesis.speak(u);
    }

    // --- SPEL LOGICA ---
    function startGame() {
        // Reset alles
        document.getElementById('win-screen').style.display = 'none';
        userContext = "";
        secretCode = [];
        
        // Bepaal lengte code
        const length = parseInt(document.getElementById('level-select').value);
        
        // Genereer code (getallen tussen 0 en 99)
        for(let i=0; i<length; i++) {
            secretCode.push(Math.floor(Math.random() * 100)); // 0 tot 99
        }
        
        updateDisplay();
        
        // Wacht even en speel dan audio
        setTimeout(playAudio, 500);
    }

    function playAudio() {
        // Zegt: "De code is: [pauze] 15 [pauze] 88 ..."
        let textToSay = "De code is... ";
        secretCode.forEach(num => {
            textToSay += num + ". ... "; // Puntjes zorgen voor pauze
        });
        speak(textToSay);
    }

    // --- UI LOGICA ---
    function press(num) {
        // Voeg nummer toe aan input. Let op: we typen de volledige getallen niet in, 
        // de cursist typt de reeks. Maar wacht...
        // Bij "Kluis kraken" typ je meestal cijfer voor cijfer.
        // ECHTER: Als de audio zegt "Vijftien", moet de cursist '1' en '5' typen.
        
        // We limiteren de input lengte voor veiligheid
        if(userContext.length < 12) {
            userContext += num;
            updateDisplay();
        }
    }

    function clearInput() {
        userContext = "";
        updateDisplay();
    }

    function updateDisplay() {
        // Toon streepjes als er niets is, of sterretjes/cijfers
        if(userContext === "") {
            document.getElementById('display').innerText = "_ _ _";
        } else {
            document.getElementById('display').innerText = userContext;
        }
    }

    function checkCode() {
        // We moeten de 'secretCode' array omzetten naar een string om te vergelijken
        // Voorbeeld: Array [15, 8] wordt String "158"
        const correctString = secretCode.join('');
        
        if (userContext === correctString) {
            // GOED!
            speak("De kluis is open! Fantastisch.");
            document.getElementById('win-screen').style.display = 'flex';
        } else {
            // FOUT!
            speak("Fout. Probeer het nog eens.");
            document.getElementById('display').innerText = "FOUT";
            document.getElementById('display').style.color = "red";
            
            setTimeout(() => {
                userContext = "";
                document.getElementById('display').style.color = "#0f0";
                updateDisplay();
            }, 1500);
        }
    }

    // Start spel bij laden
    startGame();

</script>
</body>
</html>